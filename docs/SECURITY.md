# 安全に運用するために

## APIキーについて

- APIキーは **`secrets/.env`** にだけ記入し、**コードには書かない**。
- **`.env` は git にコミットしない。** `.gitignore` で除外済み。コミット前に `git status` で `.env` が含まれていないことを確認すること。
- 本番環境では、Vercel・Railway 等の「環境変数」にキーを登録し、サーバー上のファイルではなく環境変数から読み込む。

## ローンチ前の確認

| 確認項目 | やること |
|----------|----------|
| .env がコミットされていない | `git status` で `secrets/.env` が一覧に出てこないことを確認 |
| コードにキーが直書きされていない | `OPENAI_API_KEY=` や `GEMINI_API_KEY=` でコード内を検索し、実際のキー文字列が無いことを確認 |
| 本番の環境変数 | デプロイ先のダッシュボードで、キーを「環境変数」として設定済みであることを確認 |

## もし .env を誤ってコミットしてしまったら

1. すぐにそのリポジトリの **APIキーを無効化**し、新しいキーを発行する（OpenAI / Google のダッシュボードから）。
2. 新しいキーを `.env` と本番の環境変数にだけ設定し直す。
3. git の履歴から `.env` を削除する（`git filter-branch` や BFG 等）か、リポジトリを非公開にして履歴を残さず新規リポジトリでやり直す。
